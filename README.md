# Telegram Bot —Å OpenAI, RAG –∏ –ë–∞–∑–æ–π –ó–Ω–∞–Ω–∏–π

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- –î–∏–∞–ª–æ–≥–∏ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –∏—Å—Ç–æ—Ä–∏–∏ –≤ PostgreSQL (pgvector-ready)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∏–∞–ª–æ–≥–∞–º–∏: —Å–æ–∑–¥–∞–Ω–∏–µ, –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ, —ç–∫—Å–ø–æ—Ä—Ç
- –†–æ–ª–∏ (Pro, Expert, User, CEO) –∏ —Å—Ç–∏–ª–∏ –æ—Ç–≤–µ—Ç–æ–≤
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ë–∞–∑–æ–π –∑–Ω–∞–Ω–∏–π (KB) + –ø–æ–¥–¥–µ—Ä–∂–∫–∞ PDF —Å –ø–∞—Ä–æ–ª–µ–º
- –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π RAG (—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤)
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π `/img`
- –í–µ–±-–ø–æ–∏—Å–∫ `/web`
- –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ `/kb_diag`

---

## üìú –ö–æ–º–∞–Ω–¥—ã

| –ö–æ–º–∞–Ω–¥–∞        | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------------|----------|
| `/start`       | –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ |
| `/help`        | –°–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥ |
| `/dialogs`     | –°–ø–∏—Å–æ–∫ –¥–∏–∞–ª–æ–≥–æ–≤ —Å –∫–Ω–æ–ø–∫–∞–º–∏ |
| `/rename`      | –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å —Ç–µ–∫—É—â–∏–π –¥–∏–∞–ª–æ–≥ |
| `/export`      | –≠–∫—Å–ø–æ—Ä—Ç —Ç–µ–∫—É—â–µ–≥–æ –¥–∏–∞–ª–æ–≥–∞ –≤ `.md` |
| `/kb`          | –ú–µ–Ω—é —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –∑–Ω–∞–Ω–∏–π |
| `/kb_diag`     | –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –¥–∏–∞–ª–æ–≥–∞ –∏ KB |
| `/model`       | –í—ã–±–æ—Ä –º–æ–¥–µ–ª–∏ OpenAI |
| `/mode`        | –í—ã–±–æ—Ä —Å—Ç–∏–ª—è (—Ä–æ–ª–∏) –æ—Ç–≤–µ—Ç–∞ |
| `/img`         | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è |
| `/web`         | –í–µ–±-–ø–æ–∏—Å–∫ |
| `/stats`       | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –¥–∏–∞–ª–æ–≥—É |

---

## üîò Callback-–∫–Ω–æ–ø–∫–∏

| Callback           | –î–µ–π—Å—Ç–≤–∏–µ |
|--------------------|----------|
| `dlg:new`          | –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –¥–∏–∞–ª–æ–≥ |
| `dlg:open:<id>`    | –û—Ç–∫—Ä—ã—Ç—å –¥–∏–∞–ª–æ–≥ |
| `dlg:rename:<id>`  | –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –¥–∏–∞–ª–æ–≥ |
| `dlg:export:<id>`  | –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∏–∞–ª–æ–≥ |
| `dlg:del:<id>`     | –£–¥–∞–ª–∏—Ç—å –¥–∏–∞–ª–æ–≥ |
| `kb:toggle:<idx>`  | –í—ã–±—Ä–∞—Ç—å/—Å–Ω—è—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç |
| `kb:pwd:<idx>`     | –ó–∞–ø—Ä–æ—Å–∏—Ç—å –ø–∞—Ä–æ–ª—å –∫ –¥–æ–∫—É–º–µ–Ω—Ç—É |
| `kb:save`          | –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—ã–±–æ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ |
| `kb:resync`        | –ü–µ—Ä–µ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ |

---

## üìÇ –ü—Ä–∏–º–µ—Ä—ã —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

1. **–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –¥–∏–∞–ª–æ–≥–∞**
   - `/dialogs` ‚Üí –∫–Ω–æ–ø–∫–∞ ‚ûï
   - –ë–æ—Ç —Å–æ–∑–¥–∞—Å—Ç –Ω–æ–≤—ã–π –¥–∏–∞–ª–æ–≥ –∏ —Å–¥–µ–ª–∞–µ—Ç –µ–≥–æ –∞–∫—Ç–∏–≤–Ω—ã–º.

2. **–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ**
   - `/rename` ‚Üí –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –Ω–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ.
   - –ò–ª–∏ `/dialogs` ‚Üí –∫–Ω–æ–ø–∫–∞ ‚úèÔ∏è –Ω–∞–ø—Ä–æ—Ç–∏–≤ –Ω—É–∂–Ω–æ–≥–æ –¥–∏–∞–ª–æ–≥–∞.

3. **–≠–∫—Å–ø–æ—Ä—Ç**
   - `/export` ‚Äî –±–æ—Ç –ø—Ä–∏—à–ª—ë—Ç `.md` —Ñ–∞–π–ª.
   - –ò–ª–∏ `/dialogs` ‚Üí üì§.

4. **–í–≤–æ–¥ –ø–∞—Ä–æ–ª—è –∫ PDF**
   - `/kb` ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç —Å üîí.
   - –ù–∞–∂–º–∏—Ç–µ `kb:pwd:<idx>` ‚Üí –≤–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å.

5. **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ KB**
   - `/kb_diag` ‚Äî –ø–æ–∫–∞–∂–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã–π –¥–∏–∞–ª–æ–≥, –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 —Å–æ–æ–±—â–µ–Ω–∏–π.

---

## ‚öôÔ∏è –î–µ–ø–ª–æ–π –Ω–∞ Railway
1. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç –≤ GitHub.
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç –Ω–∞ Railway.
3. –í Variables –¥–æ–±–∞–≤—å—Ç–µ:
   - `TELEGRAM_BOT_TOKEN`
   - `OPENAI_API_KEY`
   - `DATABASE_URL` (postgresql://...)
4. –î–µ–ø–ª–æ–π.
